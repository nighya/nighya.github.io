webpackJsonp([1],{"5zde":function(r,e,n){n("zQR9"),n("qyJz"),r.exports=n("FeBl").Array.from},Dhyw:function(r,e,n){var t=n("MjJU");"string"==typeof t&&(t=[[r.i,t,""]]),t.locals&&(r.exports=t.locals);n("rjj0")("93ccb9f0",t,!1,{})},Gu7T:function(r,e,n){"use strict";e.__esModule=!0;var t,s=n("c/Tr"),i=(t=s)&&t.__esModule?t:{default:t};e.default=function(r){if(Array.isArray(r)){for(var e=0,n=Array(r.length);e<r.length;e++)n[e]=r[e];return n}return(0,i.default)(r)}},MjJU:function(r,e,n){(r.exports=n("FZ+f")(!0)).push([r.i,"\n.preview[data-v-21a2eed8] {\r\n  max-width: 200px;\n}\r\n","",{version:3,sources:["C:/test/썬퍼센트/sunpercent/src/components/src/components/ContentUpload_multi.vue"],names:[],mappings:";AAkSA;EACA,iBAAA;CACA",file:"ContentUpload_multi.vue",sourcesContent:['<template>\r\n  <div class="pa-3">\r\n    <div class="ml-1">\r\n      <v-list-item-title class="text-h5"\r\n        >사진골라줘 사진올리기</v-list-item-title\r\n      >\r\n      <span style="color:gray"\r\n        >1.이미지크기는 1장당 5MB이하, 이미지갯수는 2개이상 및 3개까지만\r\n        가능합니다.<br />2.사진골라줘 통계는 모두가 볼 수 있습니다.<br />3.이미지\r\n        업로드시 2포인트 차감되며 각 게시물당 점수주기나 사진고르기로 1포인트씩\r\n        얻을 수 있습니다.</span\r\n      >\r\n    </div>\r\n    <v-row class="mt-5" no-gutters justify="center" align="center">\r\n      <v-col cols="10">\r\n        <v-form ref="form">\r\n          <v-text-field\r\n            id="제목"\r\n            label="제목"\r\n            name="email"\r\n            prepend-icon="mdi-format-title"\r\n            type="text"\r\n            counter\r\n            maxlength="50"\r\n            v-model="title"\r\n            :rules="title_rules"\r\n          ></v-text-field>\r\n          <v-file-input\r\n            chips\r\n            prepend-icon="mdi-camera"\r\n            counter\r\n            show-size\r\n            label="Select Image"\r\n            accept="image/*"\r\n            truncate-length="12"\r\n            @change="selectImage"\r\n            multiple\r\n            :rules="rules"\r\n          ></v-file-input>\r\n        </v-form>\r\n      </v-col>\r\n\r\n      <v-col cols="4" class="ma-5" align="center" justify="center">\r\n        <v-btn\r\n          class="pa-5"\r\n          align="center"\r\n          justify="center"\r\n          color="success"\r\n          dark\r\n          small\r\n          @click="upload"\r\n          :loading="loading"\r\n          :key="buttonKey"\r\n        >\r\n          Upload\r\n          <v-icon right dark>mdi-cloud-upload</v-icon>\r\n        </v-btn>\r\n      </v-col>\r\n    </v-row>\r\n\r\n    <div v-if="progress">\r\n      <div>\r\n        <v-progress-linear\r\n          v-model="progress"\r\n          color="light-blue"\r\n          height="25"\r\n          reactive\r\n        >\r\n          <strong>{{ progress }} %</strong>\r\n        </v-progress-linear>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-if="previewImage">\r\n      <div v-for="preimage in previewImage" :key="preimage">\r\n        <img class="preview my-3" :src="preimage" alt="" />\r\n      </div>\r\n    </div>\r\n\r\n    <v-alert v-if="message" border="left" color="grey" outlined dense>\r\n      {{ message }}\r\n    </v-alert>\r\n\r\n    <v-card v-if="imageInfos.length > 0" class="mx-auto">\r\n      <v-list>\r\n        <v-subheader>List of Images</v-subheader>\r\n        <v-list-item-group color="primary">\r\n          <v-list-item v-for="(image, index) in imageInfos" :key="index">\r\n            <a :href="image.url">{{ image.name }}</a>\r\n          </v-list-item>\r\n        </v-list-item-group>\r\n      </v-list>\r\n    </v-card>\r\n\r\n    <div class="text-center">\r\n      <v-dialog v-model="dialog_success" width="500" persistent>\r\n        <v-card>\r\n          <v-card-title>\r\n            이미지가 업로드 되었습니다.\r\n          </v-card-title>\r\n          <v-card-text class="mt-3">\r\n            게시물 확인은 닉네임으로 검색하거나 내정보에서 볼 수 있습니다.\r\n          </v-card-text>\r\n          <v-divider></v-divider>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color="primary" text @click="successDialog">\r\n              확인\r\n            </v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </v-dialog>\r\n    </div>\r\n    <div class="text-center">\r\n      <v-dialog v-model="dialog_fail" width="500" persistent>\r\n        <v-card>\r\n          <v-card-title>\r\n            이미지 업로드를 실패하였습니다. 이미지 1장당 크기가 5MB 초과하였거나\r\n            이미지 파일이 아닐 수 있습니다.\r\n          </v-card-title>\r\n          <v-card-text>\r\n            이미지를 다시 선택하여 시도해 보세요.\r\n          </v-card-text>\r\n          <v-divider></v-divider>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color="primary" text @click="failDialog">\r\n              확인\r\n            </v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </v-dialog>\r\n    </div>\r\n    <div class="text-center">\r\n      <v-dialog v-model="dialog_relogin" width="500" persistent>\r\n        <v-card>\r\n          <v-card-title class="text-h7 grey lighten-2">\r\n            로그인 페이지 이동\r\n          </v-card-title>\r\n          <v-card-text>\r\n            로그인 하지 않았거나 인증서 만료로 재로그인이 필요합니다.\r\n          </v-card-text>\r\n          <v-divider></v-divider>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color="primary" text @click="relogin">\r\n              확인\r\n            </v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </v-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport http from "../http/http";\r\nexport default {\r\n  name: "ContentUpload",\r\n  data() {\r\n    return {\r\n      title: null,\r\n      title_rules: [\r\n        value => !!value || "제목을 입력해 주세요.",\r\n        value =>\r\n          (value && value.length <= 50) ||\r\n          "최대 문자의 길이가 50자 이하로 입력하셔야 합니다."\r\n      ],\r\n      rules: [\r\n        files =>\r\n          !files || files.length < 4 || "사진은 최대 3개까지만 가능합니다.",\r\n        files =>\r\n          !files || files.length > 1 || "사진은 최소 2개이상 선택해 주세요."\r\n      ],\r\n      currentImage: null,\r\n      previewImage: null,\r\n      progress: 0,\r\n      message: "",\r\n      imageInfos: [],\r\n      dialog_success: false,\r\n      dialog_fail: false,\r\n      dialog_relogin: false,\r\n      loading: false,\r\n      buttonKey: 1\r\n    };\r\n  },\r\n  methods: {\r\n    selectImage(image) {\r\n      if (image) {\r\n        this.currentImage = [...image];\r\n        this.previewImage = this.currentImage.map(data =>\r\n          URL.createObjectURL(data)\r\n        );\r\n        this.progress = 0;\r\n        this.message = "";\r\n      } else {\r\n        this.currentImage = null;\r\n        this.previewImage = null;\r\n      }\r\n    },\r\n    async upload() {\r\n      const validate = this.$refs.form.validate();\r\n      if (validate) {\r\n        if (this.$store.state.loginstore.userstate[0].point <= 0) {\r\n          alert(\r\n            "게시물을 업로드 하시려면 포인트 2점이 필요합니다. 다른 게시물에 점수를 주면 포인트를 얻을 수 있습니다."\r\n          );\r\n          this.$router.go();\r\n        } else if (!this.currentImage) {\r\n          if (this.buttonKey == 0 || this.buttonKey > 1) {\r\n            return (this.buttonKey = 1);\r\n          }\r\n          this.message = "이미지가 선택되지 않았습니다.";\r\n          return;\r\n        } else {\r\n          if (this.currentImage) {\r\n            const fd = new FormData();\r\n            // fd.append("image", this.currentImage);  //OLD\r\n            //NEW ONE\r\n            for (let index = 0; index < this.currentImage.length; index++) {\r\n              let file = this.currentImage[index];\r\n              fd.append("image", file);\r\n            }\r\n            fd.append(\r\n              "user_uid",\r\n              this.$store.state.loginstore.userstate[0].user_uid\r\n            );\r\n            fd.append("title", this.title);\r\n            fd.append(\r\n              "nickname",\r\n              this.$store.state.loginstore.userstate[0].nickname\r\n            );\r\n            fd.append(\r\n              "gender",\r\n              this.$store.state.loginstore.userstate[0].gender\r\n            );\r\n            this.progress = 0;\r\n            await http\r\n              .post("/imageupload_multi", fd, {\r\n                withCredentials: true\r\n              })\r\n              .then((this.loading = true))\r\n              .then(e => {\r\n                this.loading = false;\r\n                this.dialog_success = true;\r\n                this.message = "이미지 업로드 성공";\r\n              })\r\n\r\n              .catch(err => {\r\n                if (err.response.status == 403) {\r\n                  this.dialog_relogin = true;\r\n                } else if (err.response.status == 405) {\r\n                } else if (err.response.status == 400) {\r\n                  alert(\r\n                    "게시물을 업로드 하시려면 포인트 2점이 필요합니다. 다른 게시물에 점수를 주면 포인트를 얻을 수 있습니다."\r\n                  );\r\n                  this.$router.go();\r\n                }\r\n                this.$refs.imageRef.reset();\r\n                this.currentImage = [];\r\n                this.previewImage = [];\r\n                this.loading = false;\r\n                this.dialog_fail = true;\r\n                this.message = "이미지 업로드 실패";\r\n                // console.log(err.response.status);\r\n              });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    successDialog() {\r\n      this.dialog_success = false;\r\n      this.$router.go();\r\n    },\r\n    failDialog() {\r\n      this.buttonKey++;\r\n      this.currentImage = null;\r\n      this.previewImage = null;\r\n      this.progress = 0;\r\n      this.dialog_fail = false;\r\n    },\r\n    relogin() {\r\n      this.dialog_relogin = false;\r\n      this.$router.push("/login");\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n\r\n<style scoped>\r\n.preview {\r\n  max-width: 200px;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},"c/Tr":function(r,e,n){r.exports={default:n("5zde"),__esModule:!0}},fBQ2:function(r,e,n){"use strict";var t=n("evD5"),s=n("X8DO");r.exports=function(r,e,n){e in r?t.f(r,e,s(0,n)):r[e]=n}},qyJz:function(r,e,n){"use strict";var t=n("+ZMJ"),s=n("kM2E"),i=n("sB3e"),a=n("msXi"),l=n("Mhyx"),o=n("QRG4"),c=n("fBQ2"),v=n("3fs2");s(s.S+s.F*!n("dY0y")(function(r){Array.from(r)}),"Array",{from:function(r){var e,n,s,d,u=i(r),g="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,f=void 0!==m,h=0,_=v(u);if(f&&(m=t(m,p>2?arguments[2]:void 0,2)),void 0==_||g==Array&&l(_))for(n=new g(e=o(u.length));e>h;h++)c(n,h,f?m(u[h],h):u[h]);else for(d=_.call(u),n=new g;!(s=d.next()).done;h++)c(n,h,f?a(d,m,[s.value,h],!0):s.value);return n.length=h,n}})},x8qb:function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=n("Xxa5"),s=n.n(t),i=n("exGp"),a=n.n(i),l=n("Gu7T"),o=n.n(l),c=n("GVVA"),v={name:"ContentUpload",data:function(){return{title:null,title_rules:[function(r){return!!r||"제목을 입력해 주세요."},function(r){return r&&r.length<=50||"최대 문자의 길이가 50자 이하로 입력하셔야 합니다."}],rules:[function(r){return!r||r.length<4||"사진은 최대 3개까지만 가능합니다."},function(r){return!r||r.length>1||"사진은 최소 2개이상 선택해 주세요."}],currentImage:null,previewImage:null,progress:0,message:"",imageInfos:[],dialog_success:!1,dialog_fail:!1,dialog_relogin:!1,loading:!1,buttonKey:1}},methods:{selectImage:function(r){r?(this.currentImage=[].concat(o()(r)),this.previewImage=this.currentImage.map(function(r){return URL.createObjectURL(r)}),this.progress=0,this.message=""):(this.currentImage=null,this.previewImage=null)},upload:function(){var r=this;return a()(s.a.mark(function e(){var n,t,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.$refs.form.validate()){e.next=24;break}if(!(r.$store.state.loginstore.userstate[0].point<=0)){e.next=7;break}alert("게시물을 업로드 하시려면 포인트 2점이 필요합니다. 다른 게시물에 점수를 주면 포인트를 얻을 수 있습니다."),r.$router.go(),e.next=24;break;case 7:if(r.currentImage){e.next=14;break}if(!(0==r.buttonKey||r.buttonKey>1)){e.next=10;break}return e.abrupt("return",r.buttonKey=1);case 10:return r.message="이미지가 선택되지 않았습니다.",e.abrupt("return");case 14:if(!r.currentImage){e.next=24;break}for(n=new FormData,t=0;t<r.currentImage.length;t++)i=r.currentImage[t],n.append("image",i);return n.append("user_uid",r.$store.state.loginstore.userstate[0].user_uid),n.append("title",r.title),n.append("nickname",r.$store.state.loginstore.userstate[0].nickname),n.append("gender",r.$store.state.loginstore.userstate[0].gender),r.progress=0,e.next=24,c.a.post("/imageupload_multi",n,{withCredentials:!0}).then(r.loading=!0).then(function(e){r.loading=!1,r.dialog_success=!0,r.message="이미지 업로드 성공"}).catch(function(e){403==e.response.status?r.dialog_relogin=!0:405==e.response.status||400==e.response.status&&(alert("게시물을 업로드 하시려면 포인트 2점이 필요합니다. 다른 게시물에 점수를 주면 포인트를 얻을 수 있습니다."),r.$router.go()),r.$refs.imageRef.reset(),r.currentImage=[],r.previewImage=[],r.loading=!1,r.dialog_fail=!0,r.message="이미지 업로드 실패"});case 24:case"end":return e.stop()}},e,r)}))()},successDialog:function(){this.dialog_success=!1,this.$router.go()},failDialog:function(){this.buttonKey++,this.currentImage=null,this.previewImage=null,this.progress=0,this.dialog_fail=!1},relogin:function(){this.dialog_relogin=!1,this.$router.push("/login")}}},d=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"pa-3"},[n("div",{staticClass:"ml-1"},[n("v-list-item-title",{staticClass:"text-h5"},[r._v("사진골라줘 사진올리기")]),r._v(" "),r._m(0)],1),r._v(" "),n("v-row",{staticClass:"mt-5",attrs:{"no-gutters":"",justify:"center",align:"center"}},[n("v-col",{attrs:{cols:"10"}},[n("v-form",{ref:"form"},[n("v-text-field",{attrs:{id:"제목",label:"제목",name:"email","prepend-icon":"mdi-format-title",type:"text",counter:"",maxlength:"50",rules:r.title_rules},model:{value:r.title,callback:function(e){r.title=e},expression:"title"}}),r._v(" "),n("v-file-input",{attrs:{chips:"","prepend-icon":"mdi-camera",counter:"","show-size":"",label:"Select Image",accept:"image/*","truncate-length":"12",multiple:"",rules:r.rules},on:{change:r.selectImage}})],1)],1),r._v(" "),n("v-col",{staticClass:"ma-5",attrs:{cols:"4",align:"center",justify:"center"}},[n("v-btn",{key:r.buttonKey,staticClass:"pa-5",attrs:{align:"center",justify:"center",color:"success",dark:"",small:"",loading:r.loading},on:{click:r.upload}},[r._v("\n        Upload\n        "),n("v-icon",{attrs:{right:"",dark:""}},[r._v("mdi-cloud-upload")])],1)],1)],1),r._v(" "),r.progress?n("div",[n("div",[n("v-progress-linear",{attrs:{color:"light-blue",height:"25",reactive:""},model:{value:r.progress,callback:function(e){r.progress=e},expression:"progress"}},[n("strong",[r._v(r._s(r.progress)+" %")])])],1)]):r._e(),r._v(" "),r.previewImage?n("div",r._l(r.previewImage,function(r){return n("div",{key:r},[n("img",{staticClass:"preview my-3",attrs:{src:r,alt:""}})])}),0):r._e(),r._v(" "),r.message?n("v-alert",{attrs:{border:"left",color:"grey",outlined:"",dense:""}},[r._v("\n    "+r._s(r.message)+"\n  ")]):r._e(),r._v(" "),r.imageInfos.length>0?n("v-card",{staticClass:"mx-auto"},[n("v-list",[n("v-subheader",[r._v("List of Images")]),r._v(" "),n("v-list-item-group",{attrs:{color:"primary"}},r._l(r.imageInfos,function(e,t){return n("v-list-item",{key:t},[n("a",{attrs:{href:e.url}},[r._v(r._s(e.name))])])}),1)],1)],1):r._e(),r._v(" "),n("div",{staticClass:"text-center"},[n("v-dialog",{attrs:{width:"500",persistent:""},model:{value:r.dialog_success,callback:function(e){r.dialog_success=e},expression:"dialog_success"}},[n("v-card",[n("v-card-title",[r._v("\n          이미지가 업로드 되었습니다.\n        ")]),r._v(" "),n("v-card-text",{staticClass:"mt-3"},[r._v("\n          게시물 확인은 닉네임으로 검색하거나 내정보에서 볼 수 있습니다.\n        ")]),r._v(" "),n("v-divider"),r._v(" "),n("v-card-actions",[n("v-spacer"),r._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:r.successDialog}},[r._v("\n            확인\n          ")])],1)],1)],1)],1),r._v(" "),n("div",{staticClass:"text-center"},[n("v-dialog",{attrs:{width:"500",persistent:""},model:{value:r.dialog_fail,callback:function(e){r.dialog_fail=e},expression:"dialog_fail"}},[n("v-card",[n("v-card-title",[r._v("\n          이미지 업로드를 실패하였습니다. 이미지 1장당 크기가 5MB 초과하였거나\n          이미지 파일이 아닐 수 있습니다.\n        ")]),r._v(" "),n("v-card-text",[r._v("\n          이미지를 다시 선택하여 시도해 보세요.\n        ")]),r._v(" "),n("v-divider"),r._v(" "),n("v-card-actions",[n("v-spacer"),r._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:r.failDialog}},[r._v("\n            확인\n          ")])],1)],1)],1)],1),r._v(" "),n("div",{staticClass:"text-center"},[n("v-dialog",{attrs:{width:"500",persistent:""},model:{value:r.dialog_relogin,callback:function(e){r.dialog_relogin=e},expression:"dialog_relogin"}},[n("v-card",[n("v-card-title",{staticClass:"text-h7 grey lighten-2"},[r._v("\n          로그인 페이지 이동\n        ")]),r._v(" "),n("v-card-text",[r._v("\n          로그인 하지 않았거나 인증서 만료로 재로그인이 필요합니다.\n        ")]),r._v(" "),n("v-divider"),r._v(" "),n("v-card-actions",[n("v-spacer"),r._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:r.relogin}},[r._v("\n            확인\n          ")])],1)],1)],1)],1)],1)};d._withStripped=!0;var u={render:d,staticRenderFns:[function(){var r=this.$createElement,e=this._self._c||r;return e("span",{staticStyle:{color:"gray"}},[this._v("1.이미지크기는 1장당 5MB이하, 이미지갯수는 2개이상 및 3개까지만\n      가능합니다."),e("br"),this._v("2.사진골라줘 통계는 모두가 볼 수 있습니다."),e("br"),this._v("3.이미지\n      업로드시 2포인트 차감되며 각 게시물당 점수주기나 사진고르기로 1포인트씩\n      얻을 수 있습니다.")])}]},g=u;var p=!1;var m=n("VU/8")(v,g,!1,function(r){p||n("Dhyw")},"data-v-21a2eed8",null);m.options.__file="src/components/ContentUpload_multi.vue";e.default=m.exports}});
//# sourceMappingURL=1.0ceb443c2e533732bfc8.js.map