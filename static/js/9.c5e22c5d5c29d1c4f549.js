webpackJsonp([9],{"9aFF":function(e,t){},dUsY:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),r=s.n(a),i=s("exGp"),n=s.n(i),o=s("GVVA"),l={name:"ContentUpload",data:function(){return{rules:[function(e){return!e||e.size<5242880||"사진 크기는 5MB 초과 할 수 없습니다."}],currentImage:null,previewImage:null,progress:0,message:"",imageInfos:[],dialog_success:!1,dialog_fail:!1,dialog_relogin:!1,loading:!1,buttonKey:1}},methods:{selectImage:function(e){e?(this.currentImage=e,this.previewImage=URL.createObjectURL(this.currentImage),this.progress=0,this.message=""):(this.currentImage=null,this.previewImage=null)},upload:function(){var e=this;return n()(r.a.mark(function t(){var s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.$store.state.loginstore.userstate[0].point<=0)){t.next=5;break}alert("게시물을 업로드 하시려면 포인트 2점이 필요합니다. 다른 게시물에 점수를 주면 포인트를 얻을 수 있습니다."),e.$router.go(),t.next=18;break;case 5:if(e.currentImage){t.next=10;break}if(!(0==e.buttonKey||e.buttonKey>1)){t.next=8;break}return t.abrupt("return",e.buttonKey=1);case 8:return e.message="이미지가 선택되지 않았습니다.",t.abrupt("return");case 10:return(s=new FormData).append("image",e.currentImage),s.append("user_uid",e.$store.state.loginstore.userstate[0].user_uid),s.append("nickname",e.$store.state.loginstore.userstate[0].nickname),s.append("gender",e.$store.state.loginstore.userstate[0].gender),e.progress=0,t.next=18,o.a.post("/imageupload",s,{withCredentials:!0}).then(e.loading=!0).then(function(t){e.loading=!1,e.dialog_success=!0,e.message="이미지 업로드 성공"}).catch(function(t){403==t.response.status?e.dialog_relogin=!0:405==t.response.status||400==t.response.status&&(alert("게시물을 업로드 하시려면 포인트 2점이 필요합니다. 다른 게시물에 점수를 주면 포인트를 얻을 수 있습니다."),e.$router.go()),e.$refs.imageRef.reset(),e.loading=!1,e.dialog_fail=!0,e.message="이미지 업로드 실패",e.$router.go()});case 18:case"end":return t.stop()}},t,e)}))()},successDialog:function(){this.dialog_success=!1,this.$router.go()},failDialog:function(){this.buttonKey++,this.currentImage=null,this.previewImage=null,this.progress=0,this.dialog_fail=!1},relogin:function(){this.dialog_relogin=!1,this.$router.push("/login")}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pa-3"},[s("div",{staticClass:"ml-1"},[s("v-list-item-title",{staticClass:"text-h5"},[e._v("외모점수 사진올리기")]),e._v(" "),e._m(0)],1),e._v(" "),s("v-row",{attrs:{"no-gutters":"",justify:"center",align:"center"}},[s("v-col",{attrs:{cols:"8"}},[s("v-file-input",{ref:"imageRef",attrs:{chips:"","prepend-icon":"mdi-camera",counter:"","show-size":"",label:"Select Image",accept:"image/*","truncate-length":"12",rules:e.rules},on:{change:e.selectImage}})],1),e._v(" "),s("v-col",{staticClass:"pl-4",attrs:{cols:"4"}},[s("v-btn",{key:e.buttonKey,attrs:{color:"success",dark:"",small:"",loading:e.loading},on:{click:e.upload}},[e._v("\n        Upload\n        "),s("v-icon",{attrs:{right:"",dark:""}},[e._v("mdi-cloud-upload")])],1)],1)],1),e._v(" "),e.progress?s("div",[s("div",[s("v-progress-linear",{attrs:{color:"light-blue",height:"25",reactive:""},model:{value:e.progress,callback:function(t){e.progress=t},expression:"progress"}},[s("strong",[e._v(e._s(e.progress)+" %")])])],1)]):e._e(),e._v(" "),e.previewImage?s("div",[s("div",[s("img",{staticClass:"preview my-3",attrs:{src:e.previewImage,alt:""}})])]):e._e(),e._v(" "),e.message?s("v-alert",{attrs:{border:"left",color:"grey",outlined:"",dense:""}},[e._v("\n    "+e._s(e.message)+"\n  ")]):e._e(),e._v(" "),e.imageInfos.length>0?s("v-card",{staticClass:"mx-auto"},[s("v-list",[s("v-subheader",[e._v("List of Images")]),e._v(" "),s("v-list-item-group",{attrs:{color:"primary"}},e._l(e.imageInfos,function(t,a){return s("v-list-item",{key:a},[s("a",{attrs:{href:t.url}},[e._v(e._s(t.name))])])}),1)],1)],1):e._e(),e._v(" "),s("div",{staticClass:"text-center"},[s("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.dialog_success,callback:function(t){e.dialog_success=t},expression:"dialog_success"}},[s("v-card",[s("v-card-title",[e._v("\n          이미지가 업로드 되었습니다.\n        ")]),e._v(" "),s("v-card-text",{staticClass:"mt-3"},[e._v("\n          게시물 확인은 닉네임으로 검색하거나 내정보에서 볼 수 있습니다.\n        ")]),e._v(" "),s("v-divider"),e._v(" "),s("v-card-actions",[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{color:"primary",text:""},on:{click:e.successDialog}},[e._v("\n            확인\n          ")])],1)],1)],1)],1),e._v(" "),s("div",{staticClass:"text-center"},[s("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.dialog_fail,callback:function(t){e.dialog_fail=t},expression:"dialog_fail"}},[s("v-card",[s("v-card-title",[e._v("\n          이미지 업로드를 실패하였습니다.\n        ")]),e._v(" "),s("v-card-text",[e._v("\n          이미지를 선택하여 다시 시도해 보세요.\n        ")]),e._v(" "),s("v-divider"),e._v(" "),s("v-card-actions",[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{color:"primary",text:""},on:{click:e.failDialog}},[e._v("\n            확인\n          ")])],1)],1)],1)],1),e._v(" "),s("div",{staticClass:"text-center"},[s("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.dialog_relogin,callback:function(t){e.dialog_relogin=t},expression:"dialog_relogin"}},[s("v-card",[s("v-card-title",{staticClass:"text-h7 grey lighten-2"},[e._v("\n          로그인 페이지 이동\n        ")]),e._v(" "),s("v-card-text",[e._v("\n          로그인 하지 않았거나 인증서 만료로 재로그인이 필요합니다.\n        ")]),e._v(" "),s("v-divider"),e._v(" "),s("v-card-actions",[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{color:"primary",text:""},on:{click:e.relogin}},[e._v("\n            확인\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticStyle:{color:"gray"}},[this._v("1.이미지크기는 5MB이하 이어야 하며 1장만 가능합니다."),t("br"),this._v("2.외모점수는\n      작성자만 볼 수 있습니다."),t("br"),this._v("3.이미지 업로드시 2포인트 차감되며 각\n      게시물당 점수주기나 사진고르기로 1포인트씩 얻을 수 있습니다.")])}]};var v=s("VU/8")(l,c,!1,function(e){s("9aFF")},"data-v-33131e64",null);t.default=v.exports}});
//# sourceMappingURL=9.c5e22c5d5c29d1c4f549.js.map